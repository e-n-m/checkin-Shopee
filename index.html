{
  "rules": {
    // ninguém lê direto do banco
    ".read": false,

    // gravações públicas SOMENTE em /checkins (sem login)
    "checkins": {
      "$pushId": {
        ".write": "auth == null",  // público
        // validações mínimas contra lixo
        ".validate": "
          newData.hasChildren(['id','nome','ts','lat','lng','acc']) &&
          newData.child('id').isString() &&
          newData.child('id').val().matches(/^[0-9]{3,}$/) &&
          newData.child('nome').isString() &&
          newData.child('nome').val().length <= 80 &&
          newData.child('ts').isNumber() &&
          newData.child('lat').isNumber() && newData.child('lat').val() >= -90 && newData.child('lat').val() <= 90 &&
          newData.child('lng').isNumber() && newData.child('lng').val() >= -180 && newData.child('lng').val() <= 180 &&
          newData.child('acc').isNumber()
        "
      }
    }
  }
}
